import pandas as pd
import random
from datetime import datetime, timedelta

# 1. Подготовка фейк датасета новостей
print("1. Создание фейк датасета новостей")

sample_news_texts = [
    "Центральный банк повысил ключевую ставку на 0.5% на фоне роста инфляции. Это неожиданное решение повлияет на рынки.",
    "Отчет о ВВП показал значительный рост в последнем квартале, превысив ожидания аналитиков. Рынок акций отреагировал позитивно.",
    "Крупная технологическая компания объявила о рекордной прибыли, но предупредила о замедлении роста в следующем году из-за высоких процентных ставок.",
    "Геополитическая напряженность усилилась, что привело к падению цен на нефть и росту цен на золото.",
    "Правительство объявило о новом пакете стимулирующих мер для поддержки малого бизнеса. Эксперты ожидают умеренного влияния на экономику.",
    "Курс национальной валюты стабилизировался после нескольких дней волатильности, благодаря интервенциям регулятора.",
    "Инфляция продолжает оставаться высокой, несмотря на меры центрального банка. Потребительские расходы снижаются.",
    "Новая сделка по слиянию двух гигантов в фармацевтической отрасли вызвала ажиотаж на фондовом рынке.",
    "Отчет по безработице показал незначительное улучшение, но общая ситуация на рынке труда остается сложной.",
    "Цены на сырьевые товары резко выросли из-за перебоев в поставках, что может усилить инфляционное давление."
]

end_date = datetime.now()
start_date = end_date - timedelta(days=9)
dates = [start_date + timedelta(days=i) for i in range(10)]

data = []
for date in dates:
    num_news_for_day = random.randint(1, 3) 
    for _ in range(num_news_for_day):
        data.append({
            'date': date.strftime('%Y-%m-%d'), 
            'text': random.choice(sample_news_texts)
        })

df_news = pd.DataFrame(data)
# date в datetime 
df_news['date'] = pd.to_datetime(df_news['date'])

print(f"Сгенерировано новостей: {len(df_news)}")
print(df_news.head())
print("-" * 50)

# Сохраняем датафрейм, чтобы другие скрипты могли его использовать
df_news.to_pickle('df_news.pkl')
print("Датафрейм новостей сохранен как 'df_news.pkl'")
